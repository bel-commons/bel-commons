{% extends "base.html" %}

{% import "bootstrap/wtf.html" as wtf %}
{% import "bootstrap/fixes.html" as fixes %}
{% import "bootstrap/utils.html" as util %}

{% block title %}BEL Commons Slim{% endblock %}

{% block head %}
    {{ super() }}

    <script src="//code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.13/js/dataTables.bootstrap.min.js"></script>

    <script>
        $(document).ready(function () {
            $("#networks-table").DataTable();
        });
    </script>
{% endblock %}

{% block content %}
    <div class="container" style="padding-top: 50px">
        {{ util.flashed_messages(dismissible=True, container=False) }}

        <div class="jumbotron">
            <div class="row">
                <img alt="BEL Commons Logo" width="150" style="float: left; margin-right:25px;"
                     src="{{ url_for('static', filename='img/BELcommons-square-1024.png') }}">
                <h1>BEL Commons Slim</h1>
                <small>
                    Running on PyBEL v{{ pybel_version }}, PyBEL-Tools v{{ pybel_tools_version }},
                    and BEL Commons v{{ bel_commons_version }}
                </small>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Upload</h3>
            </div>
            <div class="panel-body">
                {{ wtf.quick_form(form, form_type='horizontal', button_map={'submit_button': 'btn btn-primary'}) }}
            </div>
        </div>

        {% if tasks is defined %}
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Tasks</h3>
                </div>
                <ul>
                    {% for task in tasks %}
                        <li>
                            {{ task }}
                        </li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Networks</h3>
            </div>
            <table class="table table-striped table-striped" id="networks-table">
                <thead>
                <tr>
                    <th>Uploaded</th>
                    <th>Name</th>
                    <th>Version</th>
                    <th>Authors</th>
                    <th>Nodes</th>
                    <th>Edges</th>
                    <th>Citations</th>
                    <th>Warnings</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                {% for network in networks|sort(attribute='created', reverse=True) %}
                    <tr>
                        <td>{{ network.created.strftime('%Y-%m-%d %H:%M') }}</td>
                        <td>
                            <a href="{{ url_for('.view_network', network_id=network.id) }}">
                                {{ network.name|replace('_', ' ') }}
                            </a>
                        </td>
                        <td>{{ network.version }}</td>
                        <td>
                            {% if network.authors %}
                                {% set authors_split = network.authors.split(',') %}
                                {% if authors_split|length > 1 %}
                                    {{ authors_split[0] }}, <i>et. al</i>
                                {% else %}
                                    {{ network.authors }}
                                {% endif %}
                            {% endif %}
                        </td>
                        <td class="text-right">{{ network.report.number_nodes }}</td>
                        <td class="text-right">{{ network.report.number_edges }}</td>
                        <td class="text-right">{{ network.report.number_citations }}</td>
                        <td class="text-right">{{ network.report.number_warnings }}</td>
                        <td>
                            <a href="{{ url_for('.download', network_id=network.id) }}">
                                <span class="glyphicon glyphicon-download" aria-hidden="true"></span>
                                JGIF
                            </a>
                        </td>
                        <td>
                            <a href="{{ url_for('.upload', network_id=network.id) }}">
                                <span class="glyphicon glyphicon-upload" aria-hidden="true"></span>
                                Send
                            </a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

    </div>
{% endblock %}

